#!/bin/bash -e

dconfdir="/org/gnome/terminal/legacy/profiles:"
profile_id="$(dconf list "$dconfdir/" | tr -d /)"
profile_path="$dconfdir/$profile_id"

main() {
    local palette; palette="$(
        echo "$3" |
        sed "s/:/', '/g" |
        sed -r 's/([0-9a-fA-F]{2})/\1\1/g' |
        sed -r "s/(.*)/['\1']/g"
    )"
    set_val scrollbar-policy "'never'"
    set_val use-theme-colors false
    set_val bold-color-same-as-fg false
    set_val use-theme-transparency false
    set_val audible-bell false

    set_val background-color "'$1'"
    set_val foreground-color "'$2'"
    set_val bold-color "'$2'"
    set_val palette "$palette"
}

set_val() {
    dconf write "$profile_path/$1" "$2"
}

main "$@"
